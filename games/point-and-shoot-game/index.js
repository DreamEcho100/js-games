import X from"../../libs/core/dom.js";import{adjustCanvas as k}from"../../libs/dom.js";import{scale2dSizeToFit as I}from"../../libs/math.js";import{generateSpriteAnimationStates as f}from"../../libs/sprite.js";import{resolveBaseImportUrl as a}from"../../libs/urls.js";import"../../libs/class-names.js";import"../../libs/cleanup.js";const R=await X({assetsInfo:[{type:"image",src:import.meta.resolve("./assets/images/raven.png",new URL(import.meta.url))},{type:"image",src:a("#games/collision-animations-from-a-sprite-sheet/assets/images/boom.png")},{type:"audio",src:a("#assets/audios/Magic SFX Preview Pack/Fire impact 1.wav")},{type:"audio",src:a("#assets/audios/Magic SFX Preview Pack/Healing Full.wav")},{type:"audio",src:a("#assets/audios/Magic SFX Preview Pack/Ice attack 2.wav")},{type:"audio",src:a("#assets/audios/Magic SFX Preview Pack/Misc 02.wav")},{type:"audio",src:a("#assets/audios/Magic SFX Preview Pack/Wind effects 5.wav")}],cb:({appId:p,assets:v,cleanUpManager:o,createLayout:x})=>{const m=`${p}-canvas`,[r,c,...y]=v,s={framesX:6,width:r.naturalWidth/6,height:r.naturalHeight},S=f([{name:"default",frames:s.framesX}],{width:s.width,height:s.height}),h={framesX:5,width:c.naturalWidth/5,height:c.naturalHeight};f([{name:"default",frames:h.framesX}],{width:h.width,height:h.height});const e={render:{width:500,height:700},dom:{}};x(`<small class='block text-center'><em>In Progress</em></small><canvas
			id="${m}"
			width="${e.render.width}"
			height="${e.render.height}"
			class="border border-solid border-gray-300 dark:border-gray-700 mx-auto max-w-full w-5xl"
		></canvas>`);const n=document.getElementById(m);if(!n)throw new Error("Couldn't find the canvas!");const i=n.getContext("2d");if(!i)throw new Error("Couldn't get the canvas context!");const F=k({canvas:n,ctx:i,onUpdateCanvasSize:u=>{e.dom=u}});o.register(F);class P{constructor(t){const l=I({containerWidth:t.sprite.renderBaseWidth,containerHeight:t.sprite.renderBaseHeight,sourceWidth:t.sprite.width,sourceHeight:t.sprite.height});this.sprite={animationStates:t.sprite.animationStates,currentAnimationState:t.sprite.currentAnimationState,img:t.sprite.img,currentFrameX:0,currentFrameY:0,width:t.sprite.width,height:t.sprite.height},this.width=l.width,this.height=l.height,this.x=e.render.width,this.y=0,this.dx=Math.random()*5+3,this.dy=Math.random()*5-2.5}draw(){i.fillStyle="black",i.strokeRect(this.x,this.y,this.width,this.height),i.drawImage(this.sprite.img,this.sprite.currentFrameX*this.sprite.width,this.sprite.currentFrameY*this.sprite.height,this.sprite.width,this.sprite.height,this.x,this.y,this.width,this.height),this.x<-this.width&&(this.x=e.render.width),(this.y<0||this.y>e.render.height-this.height)&&(this.dy*=-1)}update(){this.x-=this.dx}}const g=new P({x:0,y:0,sprite:{img:r,animationStates:S,currentAnimationState:"default",renderBaseWidth:150,width:s.width,height:s.height},sfx:y[0]});let d;function w(){i.clearRect(0,0,e.render.width,e.render.height),g.draw(),g.update(),d=requestAnimationFrame(w)}o.register(()=>{d&&cancelAnimationFrame(d)}),w()}});export{R as default};
