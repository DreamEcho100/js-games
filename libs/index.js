let r=[],o=!1,a=new Set;const c=new WeakMap;function l(){for(const t of a)t();a.clear()}function g(t){const e=o;o=!0;try{t()}finally{e||(o=!1,l())}}function u(t){let e=new Set;function n(){if(r.length>0){const f=r[r.length-1];e.add(f),c.has(f)||c.set(f,new Set),c.get(f).add(e)}return t}function s(f){if(t!==f)if(t=f,o)for(const i of e)a.add(i);else for(const i of e)i()}return[n,s]}function d(t){const e=()=>{const n=c.get(e);if(n){for(const s of n)s.delete(e);n.clear()}r.push(e);try{t()}finally{r.pop()}};return e(),()=>{const n=c.get(e);if(n){for(const s of n)s.delete(e);c.delete(e)}}}function p(t){const e=u(void 0),n=d(()=>{e[1](t())});return[e[0],e[1],n]}export{p as createComputed,d as createEffect,u as createSignal,g as createSignalsBatch};
